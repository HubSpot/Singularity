#!upstart
description "Singularity Service"

env PATH=<%= node[:singularity][:home] %>/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin
env MESOS_HOME=<%= node[:mesos][:prefix] %>
env MESOS_NATIVE_LIBRARY=<%= node[:mesos][:prefix] %>/lib/libmesos.so

start on stopped rc RUNLEVEL=[2345]

respawn

exec java -Xmx512m -Djava.net.preferIPv4Stack=true -jar <%= node[:singularity][:home] %>/bin/singularity.jar server <%= node[:singularity][:conf_dir] %>/singularity.yaml >> <%= node[:singularity][:log_dir] %>/singularity.log 2>&1
